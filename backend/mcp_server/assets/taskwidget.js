import e,{useMemo as c,useState as v}from"react";var a=class extends Error{constructor(i){super(i),this.name="AppsSDKError"}},s=class s{constructor(){if(!this.isAvailable())throw new a("window.openai not available. This component must run in ChatGPT.")}static getInstance(){return s.instance||(s.instance=new s),s.instance}isAvailable(){return typeof window<"u"&&!!window.openai}get theme(){return window.openai.theme}getToolOutput(){let i=window.openai.toolOutput;if(!i)throw new a("No tool output available");return i.output}async callTool(i){try{return await window.openai.callTool(i)}catch(r){throw new a(`Failed to call tool "${i.name}": ${r}`)}}async saveState(i){try{await window.openai.setWidgetState(i)}catch(r){throw new a(`Failed to save widget state: ${r}`)}}async loadState(){try{return await window.openai.getWidgetState()}catch(i){throw new a(`Failed to load widget state: ${i}`)}}getMetadata(){return window.openai.toolOutput?._meta||null}};s.instance=null;var b=s;function y(){return b.getInstance()}var D={1:"Very Low",2:"Low",3:"Medium",4:"High",5:"Urgent"},z=()=>{let f=y(),r=f.theme==="dark",{task:o,score:_,reasoning:u}=c(()=>f.getToolOutput(),[]),[g,w]=v(!1),[d,h]=v(!1),C=async()=>{try{w(!0),await f.callTool({name:"complete_task",arguments:{task_id:o.id}}),await window.openai.sendFollowUpMessage({prompt:`Task "${o.title}" completed! What should I work on next?`})}catch(n){console.error("Failed to complete task:",n)}finally{w(!1)}},W=async n=>{try{h(!0),await f.callTool({name:"snooze_task",arguments:{task_id:o.id,hours:n}}),await window.openai.sendFollowUpMessage({prompt:`Task "${o.title}" snoozed for ${n} hours. Show me the next task.`})}catch(l){console.error("Failed to snooze task:",l)}finally{h(!1)}},S=c(()=>{if(!o.due_date)return null;let n=new Date(o.due_date),l=new Date,m=n.getTime()-l.getTime(),p=Math.ceil(m/(1e3*60*60*24));return p<0?`Overdue by ${Math.abs(p)}d`:p===0?"Due today":p===1?"Due tomorrow":p<=7?`Due in ${p}d`:`Due ${n.toLocaleDateString()}`},[o.due_date]),T=c(()=>{if(!o.effort_estimate_minutes)return null;let n=o.effort_estimate_minutes;if(n<60)return`${n}m`;let l=Math.floor(n/60),m=n%60;return m>0?`${l}h ${m}m`:`${l}h`},[o.effort_estimate_minutes]),k=c(()=>o.due_date?new Date(o.due_date)<new Date:!1,[o.due_date]),x=c(()=>{let n={light:{5:{bg:"#ffebee",text:"#c62828",border:"#ef5350"},4:{bg:"#fff3e0",text:"#e65100",border:"#ff9800"},3:{bg:"#e3f2fd",text:"#1565c0",border:"#2196f3"},2:{bg:"#f3e5f5",text:"#6a1b9a",border:"#9c27b0"},1:{bg:"#f1f8e9",text:"#558b2f",border:"#8bc34a"}},dark:{5:{bg:"#4a1616",text:"#ffcdd2",border:"#e57373"},4:{bg:"#4a3116",text:"#ffe0b2",border:"#ffb74d"},3:{bg:"#162a4a",text:"#bbdefb",border:"#64b5f6"},2:{bg:"#391646",text:"#e1bee7",border:"#ba68c8"},1:{bg:"#2d4a16",text:"#dcedc8",border:"#aed581"}}};return r?n.dark[o.priority]:n.light[o.priority]},[o.priority,r]),t={bg:r?"#1a1a1a":"#ffffff",text:r?"#ffffff":"#000000",textSecondary:r?"#b0b0b0":"#666666",border:r?"#404040":"#e0e0e0",accent:"#007aff",scoreBg:r?"rgba(0, 122, 255, 0.1)":"rgba(0, 122, 255, 0.05)",scoreBorder:r?"rgba(0, 122, 255, 0.2)":"rgba(0, 122, 255, 0.15)"};return e.createElement("div",{style:{fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif",backgroundColor:t.bg,border:`1px solid ${t.border}`,borderRadius:"8px",padding:"16px",maxWidth:"600px",width:"100%"}},e.createElement("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:600,backgroundColor:x.bg,color:x.text,border:`1px solid ${x.border}`}},e.createElement("span",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:x.border}}),D[o.priority]),e.createElement("h3",{style:{fontSize:"18px",fontWeight:600,color:t.text,margin:"12px 0 8px 0",lineHeight:1.4}},o.title),o.description&&e.createElement("p",{style:{fontSize:"14px",color:t.textSecondary,lineHeight:1.5,margin:"0 0 12px 0"}},o.description),e.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px",fontSize:"13px",color:t.textSecondary,marginBottom:"12px"}},S&&e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:k?r?"#ffcdd2":"#c62828":t.textSecondary,fontWeight:k?600:400}},e.createElement("span",null,"\u{1F4C5}"),e.createElement("span",null,S)),T&&e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px"}},e.createElement("span",null,"\u23F1\uFE0F"),e.createElement("span",null,T)),o.tags&&e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px"}},e.createElement("span",null,"\u{1F3F7}\uFE0F"),e.createElement("span",null,o.tags))),e.createElement("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:t.scoreBg,borderRadius:"6px",border:`1px solid ${t.scoreBorder}`}},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}},e.createElement("span",{style:{fontSize:"12px",fontWeight:600,color:t.accent,textTransform:"uppercase",letterSpacing:"0.5px"}},"AI Score"),e.createElement("span",{style:{fontSize:"20px",fontWeight:700,color:t.accent}},_.toFixed(1))),u.recommendation&&e.createElement("p",{style:{fontSize:"13px",color:t.text,lineHeight:1.5,margin:"8px 0 0 0"}},u.recommendation),e.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px",marginTop:"8px",fontSize:"12px"}},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0"}},e.createElement("span",{style:{color:t.textSecondary}},"Priority:"),e.createElement("span",{style:{fontWeight:600,color:t.text}},u.priority_score)),e.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0"}},e.createElement("span",{style:{color:t.textSecondary}},"Urgency:"),e.createElement("span",{style:{fontWeight:600,color:t.text}},u.deadline_urgency.toFixed(1))),e.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0"}},e.createElement("span",{style:{color:t.textSecondary}},"Effort:"),e.createElement("span",{style:{fontWeight:600,color:t.text}},u.effort_bonus)))),e.createElement("div",{style:{marginTop:"16px",display:"flex",gap:"8px",flexWrap:"wrap"}},e.createElement("button",{onClick:C,disabled:g,style:{flex:"1 1 auto",minWidth:"120px",padding:"10px 16px",backgroundColor:g?t.border:t.accent,color:"#ffffff",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:g?"not-allowed":"pointer",opacity:g?.6:1,transition:"all 0.2s"}},g?"Completing...":"\u2713 Complete Task"),e.createElement("button",{onClick:()=>W(3),disabled:d,style:{flex:"1 1 auto",minWidth:"120px",padding:"10px 16px",backgroundColor:d?t.border:"transparent",color:d?t.textSecondary:t.text,border:`1px solid ${t.border}`,borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:d?"not-allowed":"pointer",opacity:d?.6:1,transition:"all 0.2s"}},d?"Snoozing...":"\u23F0 Snooze 3h")))};export{b as AppsSDK,a as AppsSDKError,z as TaskWidget,y as getSDK};

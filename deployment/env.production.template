# MindFlow Production Environment Variables
# Copy this file to .env.production and fill in the values
# IMPORTANT: Never commit .env.production to version control!

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================

# Environment (production, staging, development)
ENVIRONMENT=production

# Application name
APP_NAME=MindFlow

# API version
API_VERSION=1.0.0

# ============================================================================
# SECURITY
# ============================================================================

# JWT Secret Key (REQUIRED)
# Generate with: openssl rand -hex 32
# CRITICAL: Must be kept secret and never shared!
SECRET_KEY=REPLACE_WITH_RANDOM_64_CHARACTER_HEX_STRING

# JWT Algorithm (recommended: HS256)
ALGORITHM=HS256

# Access token expiration (in minutes)
# Default: 1440 minutes = 24 hours
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# CORS allowed origins (comma-separated)
# Include your frontend domains and ChatGPT
# Example: https://yourdomain.com,https://chat.openai.com
CORS_ORIGINS=https://chat.openai.com,https://chatgpt.com

# ============================================================================
# DATABASE
# ============================================================================

# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
# IMPORTANT: Will be generated by migrate-db.sh script
DATABASE_URL=postgresql://mindflow_app:GENERATED_PASSWORD@localhost:5432/mindflow_prod

# Database pool settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ============================================================================
# LOGGING
# ============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log format (json or text)
LOG_FORMAT=json

# Log file path (optional, logs to stdout if not set)
# LOG_FILE=/var/log/mindflow/app.log

# ============================================================================
# RATE LIMITING
# ============================================================================

# Rate limit for general API endpoints (requests per minute)
RATE_LIMIT_API=60

# Rate limit for authentication endpoints (requests per minute)
RATE_LIMIT_AUTH=10

# Rate limit storage backend (memory or redis)
RATE_LIMIT_STORAGE=memory

# Redis URL for rate limiting (if using redis)
# REDIS_URL=redis://localhost:6379/0

# ============================================================================
# ERROR TRACKING (Optional - Sentry)
# ============================================================================

# Sentry DSN for error tracking
# Get from: https://sentry.io/
# Leave empty to disable Sentry
SENTRY_DSN=

# Sentry environment name
SENTRY_ENVIRONMENT=production

# Sentry sample rate (0.0 to 1.0)
# 1.0 = capture all errors, 0.1 = capture 10% of errors
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# PERFORMANCE
# ============================================================================

# Uvicorn workers (recommended: 2 * CPU cores)
# For 1 vCPU droplet: 2 workers
UVICORN_WORKERS=2

# Request timeout (seconds)
REQUEST_TIMEOUT=60

# Max request body size (bytes)
# 5MB = 5242880 bytes
MAX_REQUEST_SIZE=5242880

# ============================================================================
# MONITORING
# ============================================================================

# Enable health check endpoint
HEALTH_CHECK_ENABLED=true

# Health check database timeout (seconds)
HEALTH_CHECK_DB_TIMEOUT=5

# Enable request logging
REQUEST_LOGGING=true

# ============================================================================
# CHATGPT INTEGRATION
# ============================================================================

# ChatGPT Custom GPT authentication
# Users will need to authenticate via /api/auth/login
# and use the returned JWT token in ChatGPT

# OpenAPI documentation URL (for ChatGPT schema)
OPENAPI_URL=https://api.yourdomain.com/openapi.json

# API documentation URL
DOCS_URL=https://api.yourdomain.com/docs

# ============================================================================
# BACKUP
# ============================================================================

# Backup directory
BACKUP_DIR=/opt/backups/mindflow

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# ============================================================================
# DEPLOYMENT INFO (Auto-generated by CI/CD)
# ============================================================================

# Git commit hash (updated by deployment script)
# GIT_COMMIT=

# Deployment timestamp (updated by deployment script)
# DEPLOY_TIMESTAMP=

# Deployed by (updated by deployment script)
# DEPLOYED_BY=

# ============================================================================
# NOTES
# ============================================================================

# 1. After copying this file to .env.production:
#    - Generate SECRET_KEY: openssl rand -hex 32
#    - Run migrate-db.sh to generate DATABASE_URL
#    - Update CORS_ORIGINS with your domain
#    - Configure Sentry DSN if using error tracking
#
# 2. Security checklist:
#    - chmod 600 .env.production (only owner can read)
#    - Never commit .env.production to git
#    - Rotate SECRET_KEY regularly (at least quarterly)
#    - Use strong database passwords (auto-generated by migrate-db.sh)
#
# 3. Performance tuning:
#    - UVICORN_WORKERS: 2 for 1 vCPU, 4 for 2 vCPU, etc.
#    - DB_POOL_SIZE: Start with 10, increase if seeing connection errors
#    - RATE_LIMIT_API: Adjust based on usage patterns
#
# 4. Monitoring:
#    - Enable Sentry for production error tracking
#    - Set SENTRY_TRACES_SAMPLE_RATE to 0.1 (10%) to reduce overhead
#    - Monitor logs: sudo journalctl -u mindflow -f
